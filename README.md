# FindIE
Active Directory環境下にあるクライアントPCでIEを起動したイベントを収集します。  

事前にActive Direcotry グループポリシーを利用して監査の詳細の構成を下記のように設定してください。  
・プロセス作成の監査　成功を監査  
・承認ポリシーの変更の監査　監査なし  

続いて、FindIE.ps1とFindIE-execute.batをクライアントPCから読み込み可能な共有フォルダに保存してください。  
保存後、FindIE-execute.batをメモ帳で開き、最終行のPowerShellコマンドを環境に合わせて書き換えます。  
-hour イベントを収集する期間を指定します。期間は実行時刻から過去n時間を指定します（既定では24時間）。  
-path ログ出力結果を保存するパスを指定します（クライアントの編集権限があれば共有フォルダでも可）。  
-nolog 1を指定すると、IE起動イベントがみつからなかった場合でもログを出力します。1以外を指定するとイベントがみつからなかった場合にログを出力しません。  

書き換えが終わったら、Active DirectoryのログオンスクリプトポリシーでFindIE-execute.batを指定してください。  
ポリシーの適用されたクライアントPCはログオンの60秒後にイベントログを調査するPowerShellスクリプトが実行されます。  
ログ収集期間を長くすればするほど処理に時間がかかるようになります。また、セキュリティイベントログは記録数の上限があるためご注意ください。  

事前に適用した監査ポリシー変更のグループポリシーは、不要になったら必ず解除してください。  
特に承認ポリシーの変更の監査は特権昇格のイベントが記録される重要なログです。このプログラムを実行するとこのログが大量発生するため監査なしにする必要がありますが、本来は監査記録の必要なものです。  

本プログラムのサポートは基本的にありません。自己責任でお願いします。  
プログラムの変更、2次配布などはご自由に実施してください。事前連絡不要です。  
